/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package cdg.Library.View;

import cdg.Library.Dao.ClientDao;
import cdg.Library.Model.Client;

import java.awt.Image;
import java.io.File;
import java.util.List;
import javax.swing.ImageIcon;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import javax.swing.filechooser.FileNameExtensionFilter;
import javax.swing.table.DefaultTableModel;
import static org.jboss.logging.NDC.pop;

/**
 *
 * @author Zacharie
 */
public class ClientForm extends javax.swing.JInternalFrame {

    /**
     * Creates new form ClientForm
     */
    public ClientForm() {
        initComponents();
        populate_table();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        Txtregno = new javax.swing.JTextField();
        Txtfname = new javax.swing.JTextField();
        txtlname = new javax.swing.JTextField();
        txtphone = new javax.swing.JTextField();
        Txtemail = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();
        Txtphoto = new javax.swing.JTextField();
        jLabel8 = new javax.swing.JLabel();
        Txtcomboclient = new javax.swing.JComboBox();
        Btnsaveclient = new javax.swing.JButton();
        BtnUpdateclient = new javax.swing.JButton();
        BtnDeleteclient = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        Clienttable = new javax.swing.JTable();
        BtnAddPhoto = new javax.swing.JButton();
        Photo = new javax.swing.JLabel();

        setTitle("CLIENTFORM");

        jLabel2.setFont(new java.awt.Font("Tahoma", 1, 16)); // NOI18N
        jLabel2.setText("REGNO:");

        jLabel3.setFont(new java.awt.Font("Tahoma", 1, 16)); // NOI18N
        jLabel3.setText("FirstName:");

        jLabel4.setFont(new java.awt.Font("Tahoma", 1, 16)); // NOI18N
        jLabel4.setText("LastName:");

        jLabel5.setFont(new java.awt.Font("Tahoma", 1, 16)); // NOI18N
        jLabel5.setText("PhoneNumber:");

        jLabel6.setFont(new java.awt.Font("Tahoma", 1, 16)); // NOI18N
        jLabel6.setText("EmailAddress:");

        Txtfname.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                TxtfnameActionPerformed(evt);
            }
        });

        txtlname.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtlnameActionPerformed(evt);
            }
        });

        txtphone.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtphoneActionPerformed(evt);
            }
        });

        Txtemail.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                TxtemailActionPerformed(evt);
            }
        });

        jLabel7.setFont(new java.awt.Font("Tahoma", 1, 16)); // NOI18N
        jLabel7.setText("Photo:");

        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 16)); // NOI18N
        jLabel8.setText("Client Category:");

        Txtcomboclient.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Student", "Staff", "External" }));

        Btnsaveclient.setFont(new java.awt.Font("Tahoma", 1, 16)); // NOI18N
        Btnsaveclient.setText("SAVE");
        Btnsaveclient.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BtnsaveclientActionPerformed(evt);
            }
        });

        BtnUpdateclient.setFont(new java.awt.Font("Tahoma", 1, 16)); // NOI18N
        BtnUpdateclient.setText("UPDATE");
        BtnUpdateclient.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BtnUpdateclientActionPerformed(evt);
            }
        });

        BtnDeleteclient.setFont(new java.awt.Font("Tahoma", 1, 16)); // NOI18N
        BtnDeleteclient.setText("DELETE");
        BtnDeleteclient.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BtnDeleteclientActionPerformed(evt);
            }
        });

        Clienttable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "RegNo", "Firstname", "Lastname", "Phonenumber", "Photo", "Email", "Client category"
            }
        ));
        jScrollPane1.setViewportView(Clienttable);

        BtnAddPhoto.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        BtnAddPhoto.setText("UPLOADPHOTO");
        BtnAddPhoto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BtnAddPhotoActionPerformed(evt);
            }
        });

        Photo.setBorder(javax.swing.BorderFactory.createTitledBorder("PHOTO"));

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(24, 24, 24)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(Photo, javax.swing.GroupLayout.PREFERRED_SIZE, 118, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(Btnsaveclient)
                        .addGap(24, 24, 24)
                        .addComponent(BtnUpdateclient)
                        .addGap(24, 24, 24)
                        .addComponent(BtnDeleteclient)
                        .addGap(136, 136, 136)))
                .addGap(0, 236, Short.MAX_VALUE))
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel1)
                            .addComponent(jLabel4)
                            .addComponent(jLabel3)
                            .addComponent(jLabel2)
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 71, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel8))
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addGroup(layout.createSequentialGroup()
                                        .addGap(26, 26, 26)
                                        .addComponent(Txtcomboclient, javax.swing.GroupLayout.PREFERRED_SIZE, 106, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(Txtemail, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(12, 12, 12))))
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel5)
                                    .addComponent(jLabel7))
                                .addGap(18, 18, 18)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(Txtfname, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addGroup(layout.createSequentialGroup()
                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                            .addComponent(Txtphoto, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(txtphone, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(txtlname, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addGap(36, 36, 36)
                                        .addComponent(BtnAddPhoto))
                                    .addComponent(Txtregno, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE))))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.Alignment.TRAILING))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(26, 26, 26)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 14, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(Txtregno, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(24, 24, 24)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 17, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(Txtfname, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(12, 12, 12)
                        .addComponent(jLabel1)
                        .addGap(18, 18, 18)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel4)
                            .addComponent(txtlname, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(26, 26, 26))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(Photo, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)))
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtphone, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(31, 31, 31)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel7)
                    .addComponent(Txtphoto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(BtnAddPhoto))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel6)
                    .addComponent(Txtemail, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(Txtcomboclient, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(Btnsaveclient)
                    .addComponent(BtnUpdateclient)
                    .addComponent(BtnDeleteclient))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 180, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(18, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void TxtfnameActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_TxtfnameActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_TxtfnameActionPerformed

    private void txtphoneActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtphoneActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtphoneActionPerformed

    private void TxtemailActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_TxtemailActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_TxtemailActionPerformed

    private void txtlnameActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtlnameActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtlnameActionPerformed

    private void BtnsaveclientActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BtnsaveclientActionPerformed

        // TODO add your handling code here:
        
        Client client= new Client();
        client.setRegNo(Integer.parseInt(Txtregno.getText()));
        client.setFirstname(Txtfname.getText());
        client.setLastname(txtlname.getText());
        client.setPhoneNumber(Integer.parseInt(txtphone.getText()));
        client.setPhoto(Txtphoto.getText());
        client.setEmail(Txtemail.getText());
        client.setClientcategory(Txtcomboclient.getSelectedItem().toString());
        ClientDao cdao=new ClientDao();
        cdao.saveclient(client); 
        JOptionPane.showMessageDialog(null, "Data Saved Successfully!!!");
        
        
    }//GEN-LAST:event_BtnsaveclientActionPerformed

    private void BtnAddPhotoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BtnAddPhotoActionPerformed
        // TODO add your handling code here:
        JFileChooser file=new JFileChooser();
        FileNameExtensionFilter role= new FileNameExtensionFilter("png","Image","JPEG","jpg");
        if(file.showOpenDialog(null)==JFileChooser.APPROVE_OPTION){
            File f=file.getSelectedFile();
            String path=f.getAbsolutePath();
            ImageIcon image= new ImageIcon(path);
            Image img=image.getImage().getScaledInstance(Photo.getWidth(),Photo.getHeight(),Image.SCALE_SMOOTH);
            Photo.setIcon(new ImageIcon(img));
            Txtphoto.setText(path);
            
            
        }
        
        
    }//GEN-LAST:event_BtnAddPhotoActionPerformed

    private void BtnUpdateclientActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BtnUpdateclientActionPerformed
        // TODO add your handling code here:
        Client client=new Client();
        client.setRegNo(Integer.parseInt(Txtregno.getText()));
        client.setFirstname(Txtfname.getText());
        client.setLastname(txtlname.getText());
        client.setPhoneNumber(Integer.parseInt(txtphone.getText()));
        client.setPhoto(Txtphoto.getText());
        client.setEmail(Txtemail.getText());
        client.setClientcategory(Txtcomboclient.getSelectedItem().toString());
        ClientDao cdao=new ClientDao();
        cdao.UpdateClient(client);
        JOptionPane.showMessageDialog(null, "Updated Successfully!!!");
        
    }//GEN-LAST:event_BtnUpdateclientActionPerformed

    private void BtnDeleteclientActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BtnDeleteclientActionPerformed
        // TODO add your handling code here:
        Client client = new Client(Integer.parseInt(Txtregno.getText()));
         ClientDao cdao=new ClientDao();
        cdao.DeleteClient(client);
        JOptionPane.showMessageDialog(null, "Deleted Successfully!!!!");
        
        
    }//GEN-LAST:event_BtnDeleteclientActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton BtnAddPhoto;
    private javax.swing.JButton BtnDeleteclient;
    private javax.swing.JButton BtnUpdateclient;
    private javax.swing.JButton Btnsaveclient;
    private javax.swing.JTable Clienttable;
    private javax.swing.JLabel Photo;
    private javax.swing.JComboBox Txtcomboclient;
    private javax.swing.JTextField Txtemail;
    private javax.swing.JTextField Txtfname;
    private javax.swing.JTextField Txtphoto;
    private javax.swing.JTextField Txtregno;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTextField txtlname;
    private javax.swing.JTextField txtphone;
    // End of variables declaration//GEN-END:variables

    private void populate_table() {
         ClientDao dao = new ClientDao();
            List<Client> cl = dao.listAll();
            DefaultTableModel tModel = (DefaultTableModel)Clienttable.getModel();
            tModel.setRowCount(0);
            //b.stream().map((b1) -> new Object[]{
            for (Client c : cl){
                Object[] obj = new Object[] {
                c.getRegNo(),c.getFirstname(),c.getLastname(),c.getPhoneNumber(),c.getEmail(),c.getPhoto(),c.getClientcategory()
                };
            //}).forEach((o) -> {
                tModel.addRow(obj);
            //});
            }
    }
}
